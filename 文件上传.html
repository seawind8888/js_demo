<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

</head>

<body>
    <input type="file" id="file" value="上传" onchange="handleFileSelect()"/>
</body>
<script src="./js/mammoth.browser.min.js"></script>
<script>
    document.querySelector('#file').addEventListener('change', () => {
        
    })
    function handleFileSelect(event) {
        console.log('file',document.querySelector('#file').files[0])
        readFileInputEventAsArrayBuffer(event, (arrayBuffer) => {
            mammoth.convertToHtml({
                    arrayBuffer: arrayBuffer
                })
                .then((html) => {
                    console.log('html',html)
                })
                .done();
        });
    }
    function readFileInputEventAsArrayBuffer(event, callback) {
        var file = event.target.files[0];
        var reader = new FileReader();
        reader.onload = function(loadEvent) {
            var arrayBuffer = loadEvent.target.result;
            callback(arrayBuffer);
        };
        reader.readAsArrayBuffer(file);
    }
    //         //获取到选中的文件
    //         var filePath = '/Users/haifeng/Desktop/'
    //         var word = document.querySelector("#file").files[0];
    //         var fso = new ActiveXObject('Word.Application')
    //         var file = fso.createtextfile(filePath + "/测试导出.html", true);
    //         console.log(file)
</script>

</html>