<!DOCTYPE html>
<html lang="zh_cn">
<head>
    <meta charset="UTF-8">
    <title>验证码页</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="msapplication-tap-highlight" content="no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <link rel="stylesheet"
          href="//s.momocdn.com/w/css/2016/11/15/1479211078243-CPd074ae63ddbacc4a2e8289862598ae50.css"/>
    <style>
        body {
            width: 100%;
            height: 100%;
        }

        .container {
            width: 50%;
            height: 50%;
            margin: 20% auto;
            text-align: center;
        }

        #download-button {
            margin: 0 auto;
            background: blue;
            color: #fff;
            line-height: 1rem;
            text-align: center;
            display: block;
            width: 2rem;
            height: 1rem;
        }
    </style>
</head>
<body>
<iframe id="goto" src="" style="display: none;"></iframe>
<div class="container">
    <h1 id="status-msg"></h1>
    <p id="status-tips"></p>
    <a id="download-button">打开陌陌</a>
</div>
</body>
<script type="text/javascript"
        src="https://s.momocdn.com/w/js/2016/12/16/1481879684808-JP8a669e2ce53825ebb10ea956e629110a.js"></script>
<script>
    var $status = parseInt('0');
    var $status_msg = $('#status-msg');
    var $status_tips = $('#status-tips');
    //    var uid = mQuery.parse(location.search).rguid;
    var prm = {
        "username": "22222",
        "verify_code": "111"
    };
    var param = {
        "m": {
            "t": "跳转到注册页",
            "a": "goto_register",
            "prm": JSON.stringify(prm), //为了兼容旧格式
            "a_id": ""
        }
    };
    var goToUrl = 'momochat://immomo.com?goto=' + JSON.stringify(param);

//    setTimeout(function () {
//        location.href = 'http://www.immomo.com/download/ios/?d=&v=&mark=&market=&b=iOS_appstore'
//    }, 2500);
//    switch (0) {
//        case 1:
//            $status_msg.html('该手机号已注册');
//            break;
//        case 0:
//            $('.container').css('display', 'none');
//            try {
//                location.href = goToUrl;
//            } catch (e) {
//            }
//            setTimeout(function () {
//                location.href = 'https://itunes.apple.com/app/apple-store/id448165862?mt=8'
//            }, 2500);
//            break;
//        case -1:
//            $status_msg.html('链接已失效');
//            $status_tips.html('你可以打开陌陌,重新进行注册');
//            break;
//        default:
//    }
//    try {
//        location.href = goToUrl;
//    } catch (e) {
//    }
    setTimeout(function () {
        $('#goto').attr('src','http://www.immomo.com/download/ios/?d=&v=&mark=&market=&b=iOS_appstore');
//        location.href = 'http://www.immomo.com/download/ios/?d=&v=&mark=&market=&b=iOS_appstore'
    }, 2500);
    $('#download-button').on('click', function () {
        location.href = goToUrl;
        setTimeout(function () {
            location.href = 'http://www.immomo.com/download/ios/?d=&v=&mark=&market=&b=iOS_appstore'
        }, 2500)
    });
    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);  //获取url中"?"符后的字符串并正则匹配
        var context = "";
        if (r != null)
            context = r[2];
        reg = null;
        r = null;
        return context == null || context == "" || context == "undefined" ? "" : context;
    }
</script>