<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>

<body>

</body>
<script>
    function PromiseTest(fn) {
        var state = 'pending',
            value = null,
            callbacks = [];
        this.then = function (onFulfilled) {
            if (state === 'pending') {
                callbacks.push(onFulfilled);
                return this;
            }
            onFulfilled(value);
            return this;
        };
        function resolve(newValue) {
            value = newValue;
            state = 'fulfilled';
            setTimeout(function () {
                callbacks.forEach(function (callback) {
                    callback(value);
                });
            }, 0);
        }
        fn(resolve);
    }
    
    startRequest = () => {
        console.log(2)
        return new PromiseTest((resolve) => resolve())
    } 
    startRequest().then(() => {
            console.log(1)
        })
    // PromiseTest.prototype.then = () => {
    //     var fn = this.callback.shift()
    //     fn && fn()
    // }
    // PromiseTest((resolve, reject) => {
    //     resolve('232323')
    // })
    //     resolve()
    //     console.log(1)
    // })
</script>

</html>