<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

</body>
<script type="text/javascript"
        src="https://s.momocdn.com/w/js/2016/12/16/1481879684808-JP8a669e2ce53825ebb10ea956e629110a.js"></script>
<script>
    var prm = {
        "username": "1849894",
        "verify_code": "{{$data.verfiycode}}"
    };
    var param = {
        "m": {
            "t": "跳转到注册页",
            "a": "goto_register",
            "prm": JSON.stringify(prm), //为了兼容旧格式
            "a_id": ""
        }
    };
    var goToUrl = 'momochat://immomo.com?goto=' + JSON.stringify(param);
    function _GoToClient() {
        this.tasks = [];
        var self = this;
        var fn =(function(){
            return function(){
                location.href = goToUrl;
                self.next();
            }
        })();
        this.tasks.push(fn);
        setTimeout(function(){
            self.next();
        }, 0); // 在下一个事件循环启动任务
    }
    _GoToClient.prototype.next = function() {
        var fn = this.tasks.shift();
        fn && fn();
    };
    _GoToClient.prototype.Download = function () {
        var self = this;
        var fn =(function(){
            return function(){
                location.href = 'https://itunes.apple.com/cn/app/id448165862?ls=1&mt=8';
                self.next()
            }
        })();
        this.tasks.push(fn);
        return this; // 实现链式调用
    };
    function GotoClient() {
        return new _GoToClient()
    }
    GotoClient().Download()

</script>
</html>